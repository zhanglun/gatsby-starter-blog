{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/blogs/2020-03-21-使用 CSS Variable 实现主题色切换/",
    "result": {"data":{"site":{"siteMetadata":{"title":"张小伦的网络日志","description":"欢迎来到张小伦的网络日志 \n\t\t一个记录生活，分享心得的博客","menu":[{"id":"home","name":"首页","url":"/"},{"id":"category","name":"分类","url":"/categories"},{"id":"archive","name":"归档","url":"/archives"},{"id":"about","name":"关于我","url":"/about"}]}},"markdownRemark":{"id":"5ea14034-6316-5333-bf6a-528d3c4c3238","html":"<p>最近在写自己的小项目时，想试试 CSS variables，于是便有了此文。</p>\n<p>之前也使用过 Sass，Less 之类的预处理器。因为 node-sass 的安装和编译频繁出现失败的问题，所以一直都是 Less 用的比较多。当我回想日常使用Less的经历时，却发现似乎除了变量，嵌套和函数这三个特性，其他功能基本上没有太多使用。这不由得让我陷入了思考：我在自己的项目中是否还需要使用预处理器？</p>\n<p>在我的日常使用习惯中，变量主要是为了解决重复地显式书写变量名或者值，降低设计修改带来的维护成本。而嵌套和函数的使用则主要是为了服务 <a href=\"http://getbem.com/introduction/\">BEM</a> 规范的，自动编译出长长的 ClassName。</p>\n<p>使用 <code class=\"language-text\">CSS Module</code> 的方案，可以实现类似BEM规范的精髓，使用 <code class=\"language-text\">CSS custom properties</code> 提供变量的能力。二者结合使用原生CSS就能满足我的需求，无需额外的工具。</p>\n<p><code class=\"language-text\">CSS Module</code> 也具备类似预处理器的声明变量的能力，但是它的语法在 <code class=\"language-text\">.css</code> 文件中是不支持的，在我看来算是一种侵入式拓展，至于预处理器提供的 loop、condition 等能力，我相信未来的 CSS 也会支持。</p>\n<p><strong>CSS 变量(CSS variables)</strong> 是 <strong>CSS自定义属性的(CSS custom properties)<strong>的别称，有时候也会称之为</strong>级联变量(cascading variabels)</strong>。使用规定的语法定义和获取变量的值</p>\n<h2>基本用法</h2>\n<p>使用<code class=\"language-text\">--</code>作为属性名的前缀，属性值可以是任何有效的CSS值。比如<code class=\"language-text\">--main-bg-color</code>，然后通过<code class=\"language-text\">var()</code>来获取对应的属性值。不过要注意的是，自定义属性名是大小写敏感的。</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">element</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--main-bg-color</span><span class=\"token punctuation\">:</span> brown<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--main-bg-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>同时要清楚的明白：自定义属性也只是属性，仅用于匹配当前选择器及其子孙，这和通常的CSS是一样的。所以我觉得叫做<code class=\"language-text\">CSS变量</code>还是没有<code class=\"language-text\">CSS自定义属性</code>更加贴切。</p>\n<h2>作用域</h2>\n<p>JavaScript 中变量是有作用域的，要么是全局作用域，要么就是局部作用域。CSS 变量亦是如此。</p>\n<p>在CSS变量中，<code class=\"language-text\">:root</code> 选择器允许你定位到 DOM 中的最顶级元素或文档树。这种方式声明的变量就属于具有全局作用域的变量。</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--main-color</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.a</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--main-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>可以在选择器中，声明相同的自定义属性</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--main-color</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.a</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--main-color</span><span class=\"token punctuation\">:</span> green<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--main-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  //最后是 <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> green<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>继承</h2>\n<p>同普通的 CSS 属性一样，自定义属性也会被继承，如果在一个给定的元素上，没有为这个自定义属性设置值，在其父元素上的值会被使用。看一下下面的例子</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">div</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--color</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">div.test</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--color<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">div.ew</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--color<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">.test</code>和<code class=\"language-text\">.ew</code> 都会继承来自<code class=\"language-text\">div</code>的<code class=\"language-text\">--color</code>。甚至可以在HTML的style标签来设置。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!--HTML--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">--color</span><span class=\"token punctuation\">:</span> red</span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--color<span class=\"token punctuation\">)</span>；\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>有效值</h2>\n<p>在普通的 CSS 属性中，如果属性值是非法值，将会被忽略，如果有继承值，则使用继承值。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 614px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a22b5370a77c5f9a37c177348af51ccc/9453e/Xnip2020-10-05_12-48-44.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.67088607594937%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe2tQZR//8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAQEBAAAAAAAAAAAAAAAAADEQIP/aAAgBAQAGPwJhj//EABoQAAICAwAAAAAAAAAAAAAAAAABESEQQVH/2gAIAQEAAT8hhBXJKG1n/9oADAMBAAIAAwAAABBED//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EGf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAdEAEAAQMFAAAAAAAAAAAAAAABABEgMSFBUWGR/9oACAEBAAE/EN0BXAawMq+zKcnhYf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Xnip2020-10-05_12-48-44.jpg\"\n        title=\"Xnip2020-10-05_12-48-44.jpg\"\n        src=\"/static/a22b5370a77c5f9a37c177348af51ccc/9453e/Xnip2020-10-05_12-48-44.jpg\"\n        srcset=\"/static/a22b5370a77c5f9a37c177348af51ccc/ff44c/Xnip2020-10-05_12-48-44.jpg 158w,\n/static/a22b5370a77c5f9a37c177348af51ccc/a6688/Xnip2020-10-05_12-48-44.jpg 315w,\n/static/a22b5370a77c5f9a37c177348af51ccc/9453e/Xnip2020-10-05_12-48-44.jpg 614w\"\n        sizes=\"(max-width: 614px) 100vw, 614px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>当自定义属性值被解析，浏览器不知道它们什么时候会被使用，所以必须认为这些值都是有效的。但是无效的var()会使用继承值或者初始值代替。在Chrome的调试工具中可以看到，即使是无效的var(), 也不会出现被划去的横线</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 612px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b1478f267e2644ee982de2ecfbe05f07/a18e1/Xnip2020-10-05_12-54-59.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.48101265822785%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aFB/8QAFhABAQEAAAAAAAAAAAAAAAAAEQAQ/9oACAEBAAEFAjC//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAERUf/aAAgBAQABPyGkTURh/9oADAMBAAIAAwAAABBwD//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EGf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAACAQUAAAAAAAAAAAAAAAAAAREhMWGBkf/aAAgBAQABPxBWELbItUJ6YR//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Xnip2020-10-05_12-54-59.jpg\"\n        title=\"Xnip2020-10-05_12-54-59.jpg\"\n        src=\"/static/b1478f267e2644ee982de2ecfbe05f07/a18e1/Xnip2020-10-05_12-54-59.jpg\"\n        srcset=\"/static/b1478f267e2644ee982de2ecfbe05f07/ff44c/Xnip2020-10-05_12-54-59.jpg 158w,\n/static/b1478f267e2644ee982de2ecfbe05f07/a6688/Xnip2020-10-05_12-54-59.jpg 315w,\n/static/b1478f267e2644ee982de2ecfbe05f07/a18e1/Xnip2020-10-05_12-54-59.jpg 612w\"\n        sizes=\"(max-width: 612px) 100vw, 612px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>来看一下下面这个例子</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">--text-color</span><span class=\"token punctuation\">:</span> 16px<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> \n<span class=\"token selector\">p</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> \n<span class=\"token selector\">p</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--text-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>浏览器将 <code class=\"language-text\">--text-color</code> 的值替换给了 <code class=\"language-text\">var(--text-color)</code>，但是 <code class=\"language-text\">16px</code> 并不是 <code class=\"language-text\">color</code> 的合法属性值。代换之后，该属性不会产生任何作用。浏览器会执行如下两个步骤：</p>\n<ol>\n<li>检查属性 <code class=\"language-text\">color</code> 是否为继承属性。是，但是 <p> 没有任何父元素定义了 color 属性。转到2。</li>\n<li>将该值设置为它的默认初始值，浏览器中 <code class=\"language-text\">color</code>的默认值是 <code class=\"language-text\">black</code>。</li>\n</ol>\n<blockquote>\n<p>从这里也可以看出来区别于预处理器的编译，<code class=\"language-text\">CSS custom properties</code> 属于运行时。</p>\n</blockquote>\n<h2>通过 JavaScript 操作自定义属性</h2>\n<p>在这里你会发现，通过JavaScript操作自定义属性和操作CSS样式根本就是一回事。这样再次表名，这的确就是“自定义CSS属性”。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 获取一个 Dom 节点上的 CSS 变量</span>\nelement<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">getPropertyValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--my-var\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 获取任意 Dom 节点上的 CSS 变量</span>\n<span class=\"token function\">getComputedStyle</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getPropertyValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--my-var\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 修改一个 Dom 节点上的 CSS 变量</span>\nelement<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--my-var\"</span><span class=\"token punctuation\">,</span> jsVar <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>实现主题色</h2>\n<p>通过简单的代码实例来阐述说明主题色实现的方式。demo来自<a href=\"https://www.sitepoint.com/css-theming-custom-properties-javascript/\">Advanced CSS Theming with Custom Properties and JavaScript</a>。</p>\n<p>首先在全局下定义自定义属性</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--main-hue</span><span class=\"token punctuation\">:</span> 350<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>然后定义页面样式</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">nav</span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">hsl</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--main-hue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span> 50%<span class=\"token punctuation\">,</span> 50%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 1.3rem<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">hsl</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--main-hue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 50%<span class=\"token punctuation\">,</span> 10%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>如果要指定除红色以外的其他颜色，则只需将相应的值指定给 —main-hue 即可。</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--red-hue</span><span class=\"token punctuation\">:</span> 360<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--blue-hue</span><span class=\"token punctuation\">:</span> 240<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--green-hue</span><span class=\"token punctuation\">:</span> 120<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--main-hue</span> <span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--red-hue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>为红色，蓝色和绿色定义了三个自定义属性，然后将 <code class=\"language-text\">--red-hue</code> 变量分配给 <code class=\"language-text\">--main-hue</code>。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/10b850ec6128d6e2c08992b164ce38e0/90712/1535599018different-themes.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAPoAAAD6AG1e1JrAAACb0lEQVQozz3KWVPaUAAF4PwlZHlrp9O/WWniDL50OqJMraMSVBY71ORmA00CCNnIQkxys92bAE4HHzpzXs53DlG7qjW69cZNvXHdaNBHjfbXo88/q5Vuvd6r1eh6rVup3X2pdX5UPt1WK3S10a3W/4c4VpvkgqRWJKWRpN4k1RbZkpvfZiS5oKglRS2/U8tTUnkhW7Pm8ZykltTJkjp5JalXiiIce50mcbbPsl2avWfoHadJZlvrOE4QKvMM53mB8TaNE+eA8RbhMs/LHG0RJlpnravB1Uh47I3vVEeJ9vD52Thtnf++fBiORJoeK7INw632/NJund5fXoqPf8b0nTNblN4bMeIfgQpc5PnI3+BNUIS6EY6GIssqtoM8r/RcHPiFv9KF0WgG+GxtF94GO37h+oSMZBUpEpQmcDqJJy52LBPLMlIVJElwMomlaew4ODdMJMu5okJJhJIUT6bYcggmYPiQEyKei8A0nnrFRtdzlgl4LhIECLhoOoWeVySaFjBMCLiIF0IOwOkztl0CRJwYCSIUhYhfpK9+8abrOQAfdFA4X2S+X6SaHgEe8gIUxYgX0sW8cDfEU/jEhiwbsiDiBCjY2NG1/C8TMmwI2ACwIS/AtY2ylRYwTwHz8QUg4nlsWoQcK0qiqslcSdRVpgVFsLZy+SVR1XSmJrIca1oWvBWpZR+KqiQHVdKlVng+YWDLKEyjNM3SMkvTRJZhYlMvDzG2h8HYWTrOdavUjcIwSsPcGlZpWKVmEudWu+Oc00l3uBv2dw9DNL6h3Ysz61fH7t1mo/5+cL8f97F73VtftK1OJ6Hp7XBQDvrloP8PlolOlNTkNLIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1535599018different-themes.png\"\n        title=\"1535599018different-themes.png\"\n        src=\"/static/10b850ec6128d6e2c08992b164ce38e0/f058b/1535599018different-themes.png\"\n        srcset=\"/static/10b850ec6128d6e2c08992b164ce38e0/c26ae/1535599018different-themes.png 158w,\n/static/10b850ec6128d6e2c08992b164ce38e0/6bdcf/1535599018different-themes.png 315w,\n/static/10b850ec6128d6e2c08992b164ce38e0/f058b/1535599018different-themes.png 630w,\n/static/10b850ec6128d6e2c08992b164ce38e0/90712/1535599018different-themes.png 882w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>只需要通过一小段代码就可以动态修改主题色</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">'--main-hue'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">240</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>实现暗黑模式</h2>\n<p>通过这种方式，可以很方便实现现在很流行的暗黑模式。利用作用域特性，定义全局变量和局部变量，默认是浅色模式</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--links</span><span class=\"token punctuation\">:</span> #ee9ca7<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--text</span><span class=\"token punctuation\">:</span> #333<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--background-color</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.darkmode</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--text</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--links</span><span class=\"token punctuation\">:</span> #66e387<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--background-color</span><span class=\"token punctuation\">:</span> #333<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1.2rem<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--background-color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">a</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--links<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>通过 JavaSctipt 来控制 ClassName，下面是伪代码，假设有一个触发操作的按钮</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> button<span class=\"token operator\">:</span> HTMLButtonElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".color-switch\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> body<span class=\"token operator\">:</span> HTMLBodyElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  body<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">toggle</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"darkmode\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>button<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    button<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> body<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lightmode\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"Dark\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Light\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>兼容性</h2>\n<p>浏览器支持性非常好，基本所有的现代浏览器都支持良好（本文写作时已超过 95.29%）</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/78d14d5d372cdef2d1cfa0e9343c04a7/5f298/Xnip2020-10-05_13-09-19.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.0126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEAA//aAAwDAQACEAMQAAAB3WmdIL//xAAXEAADAQAAAAAAAAAAAAAAAAAAARIT/9oACAEBAAEFAtHVlH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAREP/aAAgBAQAGPwIL/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERIUGR/9oACAEBAAE/IWqK+l7gq4f/2gAMAwEAAgADAAAAEAQP/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxDXsuN//8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EBbb/8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAITGh/9oACAEBAAE/EGIC6JPtRgQWMvYszH//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Xnip2020-10-05_13-09-19.jpg\"\n        title=\"Xnip2020-10-05_13-09-19.jpg\"\n        src=\"/static/78d14d5d372cdef2d1cfa0e9343c04a7/828fb/Xnip2020-10-05_13-09-19.jpg\"\n        srcset=\"/static/78d14d5d372cdef2d1cfa0e9343c04a7/ff44c/Xnip2020-10-05_13-09-19.jpg 158w,\n/static/78d14d5d372cdef2d1cfa0e9343c04a7/a6688/Xnip2020-10-05_13-09-19.jpg 315w,\n/static/78d14d5d372cdef2d1cfa0e9343c04a7/828fb/Xnip2020-10-05_13-09-19.jpg 630w,\n/static/78d14d5d372cdef2d1cfa0e9343c04a7/0ede0/Xnip2020-10-05_13-09-19.jpg 945w,\n/static/78d14d5d372cdef2d1cfa0e9343c04a7/3ac88/Xnip2020-10-05_13-09-19.jpg 1260w,\n/static/78d14d5d372cdef2d1cfa0e9343c04a7/5f298/Xnip2020-10-05_13-09-19.jpg 2742w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>总结</h2>\n<p>下面开始技术总结</p>\n<ol>\n<li><code class=\"language-text\">CSS custom properties</code> 允许开发人员自定义CSS属性及对应的属性值</li>\n<li>自定义属性有作用域之分，<code class=\"language-text\">：root</code>可以定义全局范围的自定义属性，在选择器内部的自定义属性只能子元素下作用</li>\n<li>自定义属性也遵循CSS属性的继承和级联规则</li>\n<li>如果自定义属性的值无效，将会使用继承值或者默认值</li>\n<li>可以用JavaSctript操作自定义属性，就像操作CSS原生属性一样</li>\n</ol>","frontmatter":{"title":"使用 CSS variables 实现主题色切换","date":"March 21, 2020","description":null,"categories":[],"tags":["CSS"]}},"previous":{"fields":{"slug":"/blogs/2020-05-05-在滴滴的这几年：组件库的设计和开发/"},"frontmatter":{"title":"在滴滴的这几年：组件库的设计和开发"}},"next":{"fields":{"slug":"/blogs/2020-01-16-为Promise增加abort方法/"},"frontmatter":{"title":"为Promise增加abort方法","draft":false,"tags":[],"categories":[],"status":"publish"}}},"pageContext":{"id":"5ea14034-6316-5333-bf6a-528d3c4c3238","previousPostId":"37d451fd-2c0c-530e-889d-90211d107b3f","nextPostId":"4019b78f-b1fd-5598-8d54-48d07a6c0efa"}},
    "staticQueryHashes": ["2841359383"]}